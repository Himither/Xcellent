/* ==UserStyle==

@name			Xcellent
@namespace		github.com/Himither
@homepageURL		https://github.com/Himither/Xcellent
@supportURL		https://github.com/Himither/Xcellent/issues
@version		1.0.10
@updateURL		https://raw.githubusercontent.com/Himither/Xcellent/master/xcellent.user.css
@description		Adjustable timeline width, hide ads, hide stuff, show stuff only on hover & more
@author			Himither
@license		MIT
@preprocessor		stylus

@var checkbox		wide			"Make it wide"					1

@var text Timeline	"------------------------------------------------------" 'Timeline'

@var range		timeline-width		"Adjust timline max-width"			[900, 600, 1800, 1, "px"]
@var checkbox		timeline-header		"Stop timline header from being sticky"		0
@var checkbox		timeline-outerBorders	"Hide borders around timeline"			0
@var checkbox		timeline-postBorders	"Hide borders between posts"			0
@var checkbox		timeline-imgBorders	"Hide borders around images"			0

@var text Sidemenu	"------------------------------------------------------" 'Side menu'

@var checkbox		hoverSideMenu		"Show left menu only on hover"			0

@var text Sidebar	"------------------------------------------------------" 'Sidebar'

@var checkbox		hoverSidebar		"Show right sidebar only on hover"		0
@var checkbox		hideSearch		"Hide sidebar searchbar"			0
@var checkbox		hideLike		"Hide sidebar 'You might like'"			0
@var checkbox		hideTrends		"Hide sidebar trends"				0
@var checkbox		hideLegalNotice		"Hide sidebar legal notice"			0

@var text Other		"------------------------------------------------------" 'Other'

@var checkbox		hoverMessages		"Show bottom-left messages only on hover"	0
@var checkbox		hateBorders		"Make all borders transparent"			0
@var checkbox		hideFollow		"Hide 'Who to follow' in timeline"		0
@var checkbox		hideAds			"Hide Ads"					0

==/UserStyle== */
@-moz-document url-prefix("https://x.com") {

	:root:has(body[style*="rgb(0"]) {
		--bg: rgb(0, 0, 0);
	}

	:root:has(body[style*="rgb(21"]) {
		--bg: rgb(21, 32, 43);
	}

	:root:has(body[style*="rgb(255"]) {
		--bg: rgb(255, 255, 255);
	}

	/* Formerly known as Twitter ¯\_(ツ)_/¯ */
	if wide {
		header[role="banner"] {
			position: absolute !important;
			left: 0 !important;
		}

		header[role="banner"] > div {
			position: absolute !important;
			left: 0 !important;
			margin-left: 0 !important;
		}

		header[role="banner"] > div > div {
			left: 0 !important;
		}

		main[role="main"] > div {
			width: 100dvw !important;
		}

		[data-testid="primaryColumn"] {
			position: absolute !important;
			left: 275px !important;
			width: auto !important;
			margin: auto !important;
			max-width: timeline-width !important;
			right: calc(382px + 32px) !important;
			transform: translateX(0) !image-orientation;
		}


		[data-testid="primaryColumn"] > div > div:last-child,
		[data-testid="primaryColumn"] > div > div:last-child > div > div {
			min-width: unset !important;
			max-width: unset !important;
			width: 100% !important;
			margin: 0 !important;
		}

		[data-testid="sidebarColumn"] {
			position: absolute !important;
			right: 0 !important;
			padding-right: 32px !important;
			margin-right: 0 !important;
			width: 382px !important;
			min-width: unset !important;
			max-width: unset !important;
		}

		[data-testid="sidebarColumn"] > div {
			align-items: flex-end !important;
			width: 100% !important;
		}

		[data-testid="sidebarColumn"] > div > div {
			width: 350px !important;
		}


		if hoverSideMenu or hoverSidebar {
			[data-testid="primaryColumn"] {
				transition: all 300ms ease-in-out !important;
			}
		}

		if hoverSideMenu {
			[data-testid="primaryColumn"] {
				left: 0 !important;
			}

			header[role="banner"] > div > div {
				background-color: var(--bg) !important;
			}
		}

		if hoverSidebar {
			[data-testid="primaryColumn"] {
				z-index: 0 !important;
				right: 32px !important;
			}

			[data-testid="sidebarColumn"]:hover {
				width: 414px !important;
				background-color: var(--bg) !important;
			}
		}

		@media screen and (max-width: 1264px) {

			header[role="banner"] > div > div > div {
				width: 68px !important;
			}

			[data-testid="primaryColumn"] {
				left: 68px !important;
			}
		}

		@media screen and (max-width: 987px) {
			[data-testid="primaryColumn"] {
				right: 0 !important;
			}
		}


		@media screen and (max-width: 499px) {
			[data-testid="primaryColumn"] {
				left: 0 !important;
			}
		}
	}

	/* Timeline */
	if timeline-header {
		[data-testid="primaryColumn"] > div > div:first-child {
			position: unset !important;
		}
	}

	if timeline-outerBorders {

		[data-testid="primaryColumn"] {
			border-color: transparent !important
		}
	}

	if timeline-postBorders {

		[data-testid="primaryColumn"] nav,
		[data-testid="primaryColumn"] section[role="region"] > div > div > div > div {
			border-color: transparent !important
		}
	}

	/* For this one I'll have to trust the sussy class. Can't figure out a smart selector... */
	if timeline-imgBorders {
		[data-testid="primaryColumn"] .r-1kqtdi0 {
			border-color: transparent !important
		}
	}

	if timeline-postBorders or hateBorders {
		[data-testid="primaryColumn"]:has(article) > div > div:nth-child(4),
		[data-testid="primaryColumn"] section[role="region"] > div > div > div > div > div {
			background-color: transparent !important;
		}
	}

	/* Side menu */
	if hoverSideMenu {
		header[role="banner"] > div > div {
			opacity: 0 !important;
			transition: all 300ms ease-in-out !important;
		}

		header[role="banner"] > div > div:hover {
			opacity: 1 !important;
		}

		if wide {
			header[role="banner"] > div > div {
				left: calc(-275px + 32px) !important;
			}

			header[role="banner"] > div > div:hover {
				left: 0px !important;
			}

			@media screen and (max-width: 1264px) {
				header[role="banner"] > div > div {
					left: calc(-88px + 32px) !important;
				}

				header[role="banner"] > div > div:hover {
					left: 0 !important;
				}
			}
		}
	}

	/* Sidebar */
	if hoverSidebar {
		[data-testid="sidebarColumn"] {
			height: 100dvh !important;
			opacity: 0 !important;
			transition: all 300ms ease-in-out !important;
		}

		[data-testid="sidebarColumn"]:hover {
			opacity: 1 !important;
		}

		if wide {
			[data-testid="sidebarColumn"] {
				transition: all 300ms ease-in-out !important;
			}

			[data-testid="sidebarColumn"] {
				transform: translateX(calc(100% - 32px)) !important;
			}

			[data-testid="sidebarColumn"] {
				position: fixed !important;
			}

			[data-testid="sidebarColumn"]:hover {
				transform: translateX(0) !important;
			}

			[data-testid="sidebarColumn"]:hover > div > div > div > div > div > div:first-child {
				transform: translateX(0) !important;
			}
		}
	}

	if hideSearch {
		[data-testid="sidebarColumn"]:has(section) > div > div > div > div > div > div:nth-child(1) {
			display: none !important;
		}
	}

	if hideLike {
		[data-testid="sidebarColumn"]:has(section) > div > div > div > div > div > div:nth-last-child(3) {
			display: none !important;
		}
	}

	if hideTrends {
		[data-testid="sidebarColumn"]:has(section) > div > div > div > div > div > div:nth-last-child(2) {
			display: none !important;
		}

		/*		[data-testid="sidebarColumn"] > div > div > div > div > div > div:first-child {
			right: 32px !important;
			width: fit-content !important;
		} */
	}

	if hideLegalNotice {
		[data-testid="sidebarColumn"]:has(section) > div > div > div > div > div > div:nth-last-child(1) {
			display: none !important;
		}
	}

	/* Others */
	if hoverMessages {
		div#layers div[data-testid="DMDrawer"] {
			opacity: 0 !important;
			transform: translateX(90%) !important;
			margin-right: 0px !important;
			padding-right: 32px !important;
			transition: all 300ms ease-in-out !important;
		}

		div#layers div[data-testid="DMDrawer"]:hover {
			opacity: 1 !important;
			transform: translateX(0) !important;
		}
	}

	if hateBorders {
		* {
			border-color: transparent !important;
		}
	}

	if hideFollow {
		div[aria-label$="posts"] > div > div:not(:has(:is(article, a[href^="/i/status"], [role="progressbar"], button > div > svg))) {
			display: none !important;
		}
	}

	if hideAds {
		main section > div > div > div:has(article > div > div > div > div > div > div > div > div > div > span) {
			display: none !important;
		}
	}
}